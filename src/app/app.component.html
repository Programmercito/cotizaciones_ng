<div class="dashboard">
  <!-- Header -->
  <header class="header">
    <div class="header__brand">
      <div class="header__logo">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
          <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"
                stroke="#6366f1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <h1 class="header__title">Cotizaciones <span>USDT</span></h1>
    </div>
    <div class="header__meta">
      @if (ultimaCotizacion(); as ultima) {
        <span class="header__exchange">{{ ultima.exchange }}</span>
      }
    </div>
  </header>

  <!-- Loading state -->
  @if (loading()) {
    <div class="loading">
      <div class="loading__spinner"></div>
      <p>Cargando cotizaciones...</p>
    </div>
  }

  <!-- Error state -->
  @if (error(); as err) {
    <div class="error-card">
      <p>{{ err }}</p>
    </div>
  }

  <!-- Content -->
  @if (!loading() && !error()) {
    <!-- Stats cards -->
    <div class="stats">
      <div class="stat-card stat-card--primary">
        <span class="stat-card__label">Precio Actual</span>
        <span class="stat-card__value">
          BOB {{ ultimaCotizacion()?.cotizacion | number:'1.2-2' }}
        </span>
        <span class="stat-card__sub">1 USDT</span>
      </div>

      <div class="stat-card">
        <span class="stat-card__label">Maximo</span>
        <span class="stat-card__value stat-card__value--up">
          BOB {{ cotizacionMax() | number:'1.2-2' }}
        </span>
      </div>

      <div class="stat-card">
        <span class="stat-card__label">Minimo</span>
        <span class="stat-card__value stat-card__value--down">
          BOB {{ cotizacionMin() | number:'1.2-2' }}
        </span>
      </div>

      <div class="stat-card">
        <span class="stat-card__label">Variacion</span>
        <span class="stat-card__value"
              [class.stat-card__value--up]="variacion() >= 0"
              [class.stat-card__value--down]="variacion() < 0">
          {{ variacion() >= 0 ? '+' : '' }}{{ variacion() | number:'1.2-4' }}%
        </span>
      </div>
    </div>

    <!-- Chart -->
    <div class="chart-container">
      <div class="chart-container__header">
        <h2>Historial de Cotizaciones</h2>
        <span class="chart-container__badge">En vivo</span>
      </div>
      <div class="chart-container__body">
        <canvas #chartCanvas></canvas>
      </div>
    </div>

    <!-- Table -->
    <div class="table-container">
      <h2>Registro Detallado</h2>
      <div class="table-scroll">
        <table class="data-table">
          <thead>
            <tr>
              <th>Fecha y Hora</th>
              <th>Moneda</th>
              <th>Cotizacion (BOB)</th>
              <th>Exchange</th>
            </tr>
          </thead>
          <tbody>
            @for (item of cotizaciones(); track item.datetime) {
              <tr>
                <td>{{ item.datetime }}</td>
                <td><span class="badge">{{ item.moneda }}</span></td>
                <td class="price">{{ item.cotizacion | number:'1.2-2' }}</td>
                <td>{{ item.exchange }}</td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <p>Datos obtenidos de Binance P2P &mdash; Ultima actualizacion: {{ ultimaCotizacion()?.datetime }}</p>
    </footer>
  }
</div>
